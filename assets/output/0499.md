---
title: 499. 迷宫 III 🔒
description: LeetCode 499. 迷宫 III 🔒题解，The Maze III，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 499. 迷宫 III 🔒
  - 迷宫 III
  - The Maze III
  - 解题思路
  - 深度优先搜索
  - 广度优先搜索
  - 图
  - 数组
  - 字符串
  - 矩阵
  - 最短路
  - 堆（优先队列）
---

# 499. 迷宫 III 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`深度优先搜索`](/tag/depth-first-search.md) [`广度优先搜索`](/tag/breadth-first-search.md) [`图`](/tag/graph.md) [`数组`](/tag/array.md) [`字符串`](/tag/string.md) [`矩阵`](/tag/matrix.md) [`最短路`](/tag/shortest-path.md) [`堆（优先队列）`](/tag/heap-priority-queue.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/the-maze-iii) [`LeetCode`](https://leetcode.com/problems/the-maze-iii)

## 题目

There is a ball in a `maze` with empty spaces (represented as `0`) and walls
(represented as `1`). The ball can go through the empty spaces by rolling
**up, down, left or right** , but it won't stop rolling until hitting a wall.
When the ball stops, it could choose the next direction. There is also a hole
in this maze. The ball will drop into the hole if it rolls onto the hole.

Given the `m x n` `maze`, the ball's position `ball` and the hole's position
`hole`, where `ball = [ballrow, ballcol]` and `hole = [holerow, holecol]`,
return _a string_`instructions` _of all the instructions that the ball should
follow to drop in the hole with the**shortest distance** possible_. If there
are multiple valid instructions, return the **lexicographically minimum** one.
If the ball can't drop in the hole, return `"impossible"`.

If there is a way for the ball to drop in the hole, the answer `instructions`
should contain the characters `'u'` (i.e., up), `'d'` (i.e., down), `'l'`
(i.e., left), and `'r'` (i.e., right).

The **distance** is the number of **empty spaces** traveled by the ball from
the start position (excluded) to the destination (included).

You may assume that **the borders of the maze are all walls** (see examples).



**Example 1:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0400-0499/0499.The%20Maze%20III/images/maze3-1-grid.jpg)

> Input: maze = [[0,0,0,0,0],[1,1,0,0,1],[0,0,0,0,0],[0,1,0,0,1],[0,1,0,0,0]], ball = [4,3], hole = [0,1]
> 
> Output: "lul"
> 
> Explanation: There are two shortest ways for the ball to drop into the hole.
> 
> The first way is left -> up -> left, represented by "lul".
> 
> The second way is up -> left, represented by 'ul'.
> 
> Both ways have shortest distance 6, but the first way is lexicographically smaller because 'l' < 'u'. So the output is "lul".

**Example 2:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0400-0499/0499.The%20Maze%20III/images/maze3-2-grid.jpg)

> Input: maze = [[0,0,0,0,0],[1,1,0,0,1],[0,0,0,0,0],[0,1,0,0,1],[0,1,0,0,0]], ball = [4,3], hole = [3,0]
> 
> Output: "impossible"
> 
> Explanation: The ball cannot reach the hole.

**Example 3:**

> Input: maze = [[0,0,0,0,0,0,0],[0,0,1,0,0,1,0],[0,0,0,0,1,0,0],[0,0,0,0,0,0,1]], ball = [0,4], hole = [3,5]
> 
> Output: "dldr"

**Constraints:**

  * `m == maze.length`
  * `n == maze[i].length`
  * `1 <= m, n <= 100`
  * `maze[i][j]` is `0` or `1`.
  * `ball.length == 2`
  * `hole.length == 2`
  * `0 <= ballrow, holerow <= m`
  * `0 <= ballcol, holecol <= n`
  * Both the ball and the hole exist in an empty space, and they will not be in the same position initially.
  * The maze contains **at least 2 empty spaces**.


## 题目大意

由空地和墙组成的迷宫中有一个**球** 。球可以向**上（u）下（d）左（l）右（r）**
四个方向滚动，但在遇到墙壁前不会停止滚动。当球停下时，可以选择下一个方向。迷宫中还有一个**洞** ，当球运动经过洞时，就会掉进洞里。

给定球的**起始位置，目的地** 和**迷宫** ，找出让球以最短距离掉进洞里的路径。 距离的定义是球从起始位置（不包括）到目的地（包括）经过的**空地**
个数。通过'u', 'd', 'l' 和 'r'输出球的移动**方向** 。 由于可能有多条最短路径， 请输出**字典序最小** 的路径**。**
如果球无法进入洞，输出"impossible"。

迷宫由一个0和1的二维数组表示。 1表示墙壁，0表示空地。你可以假定迷宫的边缘都是墙壁。起始位置和目的地的坐标通过行号和列号给出。



**示例1:**

> 
> 
> 
> 
> 
> **输入 1:** 迷宫由以下二维数组表示
> 
> 
> 
> 0 0 0 0 0
> 
> 1 1 0 0 1
> 
> 0 0 0 0 0
> 
> 0 1 0 0 1
> 
> 0 1 0 0 0
> 
> 
> 
> **输入 2:** 球的初始位置 (rowBall, colBall) = (4, 3)
> 
> **输入 3:** 洞的位置 (rowHole, colHole) = (0, 1)
> 
> 
> 
> **输出:** "lul"
> 
> 
> 
> **解析:** 有两条让球进洞的最短路径。
> 
> 第一条路径是 左 -> 上 -> 左, 记为 "lul".
> 
> 第二条路径是 上 -> 左, 记为 'ul'.
> 
> 两条路径都具有最短距离6, 但'l' < 'u'，故第一条路径字典序更小。因此输出"lul"。
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0400-0499/0499.The%20Maze%20III/images/maze_2_example_1.png)
> 
> 

**示例  2:**

> 
> 
> 
> 
> 
> **输入 1:** 迷宫由以下二维数组表示
> 
> 
> 
> 0 0 0 0 0
> 
> 1 1 0 0 1
> 
> 0 0 0 0 0
> 
> 0 1 0 0 1
> 
> 0 1 0 0 0
> 
> 
> 
> **输入 2:** 球的初始位置 (rowBall, colBall) = (4, 3)
> 
> **输入 3:** 洞的位置 (rowHole, colHole) = (3, 0)
> 
> 
> 
> **输出:** "impossible"
> 
> 
> 
> **示例:** 球无法到达洞。
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0400-0499/0499.The%20Maze%20III/images/maze_2_example_2.png)
> 
> 



**注意:**

  1. 迷宫中只有一个球和一个目的地。
  2. 球和洞都在空地上，且初始时它们不在同一位置。
  3. 给定的迷宫不包括边界 (如图中的红色矩形), 但你可以假设迷宫的边缘都是墙壁。
  4. 迷宫至少包括2块空地，行数和列数均不超过30。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 490 | 迷宫 🔒 |  |  [`深度优先搜索`](/tag/depth-first-search.md) [`广度优先搜索`](/tag/breadth-first-search.md) [`数组`](/tag/array.md) `1+` | 🟠 | [🀄️](https://leetcode.cn/problems/the-maze) [🔗](https://leetcode.com/problems/the-maze) |
| 505 | 迷宫 II 🔒 |  |  [`深度优先搜索`](/tag/depth-first-search.md) [`广度优先搜索`](/tag/breadth-first-search.md) [`图`](/tag/graph.md) `4+` | 🟠 | [🀄️](https://leetcode.cn/problems/the-maze-ii) [🔗](https://leetcode.com/problems/the-maze-ii) |
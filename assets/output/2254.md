---
title: 2254. 设计视频共享平台 🔒
description: LeetCode 2254. 设计视频共享平台 🔒题解，Design Video Sharing Platform，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 2254. 设计视频共享平台 🔒
  - 设计视频共享平台
  - Design Video Sharing Platform
  - 解题思路
  - 栈
  - 设计
  - 哈希表
  - 有序集合
---

# 2254. 设计视频共享平台 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`栈`](/tag/stack.md) [`设计`](/tag/design.md) [`哈希表`](/tag/hash-table.md) [`有序集合`](/tag/ordered-set.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/design-video-sharing-platform) [`LeetCode`](https://leetcode.com/problems/design-video-sharing-platform)

## 题目

You have a video sharing platform where users can upload and delete videos.
Each `video` is a **string** of digits, where the `ith` digit of the string
represents the content of the video at minute `i`. For example, the first
digit represents the content at minute `0` in the video, the second digit
represents the content at minute `1` in the video, and so on. Viewers of
videos can also like and dislike videos. Internally, the platform keeps track
of the **number of views, likes, and dislikes** on each video.

When a video is uploaded, it is associated with the smallest available integer
`videoId` starting from `0`. Once a video is deleted, the `videoId` associated
with that video can be reused for another video.

Implement the `VideoSharingPlatform` class:

  * `VideoSharingPlatform()` Initializes the object.
  * `int upload(String video)` The user uploads a `video`. Return the `videoId` associated with the video.
  * `void remove(int videoId)` If there is a video associated with `videoId`, remove the video.
  * `String watch(int videoId, int startMinute, int endMinute)` If there is a video associated with `videoId`, increase the number of views on the video by `1` and return the substring of the video string starting at `startMinute` and ending at `min(endMinute, video.length - 1``)` (**inclusive**). Otherwise, return `"-1"`.
  * `void like(int videoId)` Increases the number of likes on the video associated with `videoId` by `1` if there is a video associated with `videoId`.
  * `void dislike(int videoId)` Increases the number of dislikes on the video associated with `videoId` by `1` if there is a video associated with `videoId`.
  * `int[] getLikesAndDislikes(int videoId)` Return a **0-indexed** integer array `values` of length `2` where `values[0]` is the number of likes and `values[1]` is the number of dislikes on the video associated with `videoId`. If there is no video associated with `videoId`, return `[-1]`.
  * `int getViews(int videoId)` Return the number of views on the video associated with `videoId`, if there is no video associated with `videoId`, return `-1`.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["VideoSharingPlatform", "upload", "upload", "remove", "remove", "upload", "watch", "watch", "like", "dislike", "dislike", "getLikesAndDislikes", "getViews"]
> 
> [[], ["123"], ["456"], [4], [0], ["789"], [1, 0, 5], [1, 0, 1], [1], [1], [1], [1], [1]]
> 
> **Output**
> 
> [null, 0, 1, null, null, 0, "456", "45", null, null, null, [1, 2], 2]
> 
> 
> 
> **Explanation**
> 
> VideoSharingPlatform videoSharingPlatform = new VideoSharingPlatform();
> 
> videoSharingPlatform.upload("123");> 
> > 
>   // The smallest available videoId is 0, so return 0.
> 
> videoSharingPlatform.upload("456");> 
> > 
>   // The smallest available videoId is 1, so return 1.
> 
> videoSharingPlatform.remove(4);> 
> > 
> > 
>   // There is no video associated with videoId 4, so do nothing.
> 
> videoSharingPlatform.remove(0);> 
> > 
> > 
>   // Remove the video associated with videoId 0.
> 
> videoSharingPlatform.upload("789");> 
> > 
>   // Since the video associated with videoId 0 was deleted,
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // 0 is the smallest available videoId, so return 0.
> 
> videoSharingPlatform.watch(1, 0, 5);> 
> > 
>  // The video associated with videoId 1 is "456".
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // The video from minute 0 to min(5, 3 - 1) = 2 is "456", so return "456".
> 
> videoSharingPlatform.watch(1, 0, 1);> 
> > 
>  // The video associated with videoId 1 is "456".
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // The video from minute 0 to min(1, 3 - 1) = 1 is "45", so return "45".
> 
> videoSharingPlatform.like(1);> 
> > 
> > 
> > 
> // Increase the number of likes on the video associated with videoId 1.
> 
> videoSharingPlatform.dislike(1);> 
> > 
> > 
>  // Increase the number of dislikes on the video associated with videoId 1.
> 
> videoSharingPlatform.dislike(1);> 
> > 
> > 
>  // Increase the number of dislikes on the video associated with videoId 1.
> 
> videoSharingPlatform.getLikesAndDislikes(1); // There is 1 like and 2 dislikes on the video associated with videoId 1, so return [1, 2].
> 
> videoSharingPlatform.getViews(1);> 
> > 
> > 
> // The video associated with videoId 1 has 2 views, so return 2.

**Example 2:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["VideoSharingPlatform", "remove", "watch", "like", "dislike", "getLikesAndDislikes", "getViews"]
> 
> [[], [0], [0, 0, 1], [0], [0], [0], [0]]
> 
> **Output**
> 
> [null, null, "-1", null, null, [-1], -1]
> 
> 
> 
> **Explanation**
> 
> VideoSharingPlatform videoSharingPlatform = new VideoSharingPlatform();
> 
> videoSharingPlatform.remove(0);> 
> > 
> > 
>   // There is no video associated with videoId 0, so do nothing.
> 
> videoSharingPlatform.watch(0, 0, 1);> 
> > 
>  // There is no video associated with videoId 0, so return "-1".
> 
> videoSharingPlatform.like(0);> 
> > 
> > 
> > 
> // There is no video associated with videoId 0, so do nothing.
> 
> videoSharingPlatform.dislike(0);> 
> > 
> > 
>  // There is no video associated with videoId 0, so do nothing.
> 
> videoSharingPlatform.getLikesAndDislikes(0); // There is no video associated with videoId 0, so return [-1].
> 
> videoSharingPlatform.getViews(0);> 
> > 
> > 
> // There is no video associated with videoId 0, so return -1.

**Constraints:**

  * `1 <= video.length <= 10^5`
  * The sum of `video.length` over all calls to `upload` does not exceed `10^5`
  * `video` consists of digits.
  * `0 <= videoId <= 10^5`
  * `0 <= startMinute < endMinute < 10^5`
  * `startMinute < video.length`
  * The sum of `endMinute - startMinute` over all calls to `watch` does not exceed `10^5`.
  * At most `10^5` calls **in total** will be made to all functions.


## 题目大意

你有一个视频分享平台，用户可以上传和删除视频。每个 `video` 都是 **字符串  **类型的数字，其中字符串的第 `i` 位表示视频中第 `i`
分钟的内容。例如，第一个数字表示视频中第 `0` 分钟的内容，第二个数字表示视频中第 `1`
分钟的内容，以此类推。视频的观众也可以喜欢和不喜欢视频。该平台会跟踪每个视频的 **观看次数** 、**点赞次数  **和 **不喜欢次数** 。

当视频上传时，它与最小可用整数 `videoId` 相关联，`videoId` 从 `0` 开始的。一旦一个视频被删除，与该视频关联的 `videoId`
就可以用于另一个视频。

实现 `VideoSharingPlatform` 类:

  * `VideoSharingPlatform()` 初始化对象。
  * `int upload(String video)` 用户上传一个 `video`. 返回与视频相关联的`videoId` 。
  * `void remove(int videoId)` 如果存在与 `videoId` 相关联的视频，则删除该视频。
  * `String watch(int videoId, int startMinute, int endMinute)` 如果有一个视频与 `videoId` 相关联，则将该视频的观看次数增加 `1`，并返回视频字符串的子字符串，从 `startMinute` 开始，以 `min(endMinute, video.length - 1``)`(含边界) 结束。否则，返回 `"-1"`。
  * `void like(int videoId)` 如果存在与 `videoId` 相关联的视频，则将与 `videoId` 相关联的视频的点赞数增加 `1`。
  * `void dislike(int videoId)` 如果存在与 `videoId` 相关联的视频，则将与 `videoId` 相关联的视频上的不喜欢次数增加 `1`。
  * `int[] getLikesAndDislikes(int videoId)` 返回一个长度为 `2` ，**下标从 0 开始** 的整型数组，其中 `values[0]` 是与 `videoId` 相关联的视频上的点赞数，`values[1]` 是不喜欢数。如果没有与 `videoId` 相关联的视频，则返回 `[-1]`。
  * `int getViews(int videoId)` 返回与 `videoId` 相关联的视频的观看次数，如果没有与 `videoId` 相关联的视频，返回 `-1`。



**示例 1:**

> 
> 
> 
> 
> 
> **输入**
> 
> ["VideoSharingPlatform", "upload", "upload", "remove", "remove", "upload", "watch", "watch", "like", "dislike", "dislike", "getLikesAndDislikes", "getViews"]
> 
> [[], ["123"], ["456"], [4], [0], ["789"], [1, 0, 5], [1, 0, 1], [1], [1], [1], [1], [1]]
> 
> **输出**
> 
> [null, 0, 1, null, null, 0, "456", "45", null, null, null, [1, 2], 2]
> 
> 
> 
> **解释**
> 
> VideoSharingPlatform videoSharingPlatform = new VideoSharingPlatform();
> 
> videoSharingPlatform.upload("123");> 
> > 
>   // 最小的可用 videoId 是 0，所以返回 0。
> 
> videoSharingPlatform.upload("456");> 
> > 
>   // 最小的可用 videoId 是 1，所以返回 1。
> 
> videoSharingPlatform.remove(4);> 
> > 
> > 
>   // 没有与 videoId 4 相关联的视频，所以什么都不做。
> 
> videoSharingPlatform.remove(0);> 
> > 
> > 
>   // 删除与 videoId 0 关联的视频。
> 
> videoSharingPlatform.upload("789");> 
> > 
>   // 由于与 videoId 0 相关联的视频被删除，
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // 0 是最小的可用 videoId，所以返回 0。
> 
> videoSharingPlatform.watch(1, 0, 5);> 
> > 
>  // 与 videoId 1 关联的视频为 "456"。
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // 从分钟 0 到分钟 min(5,3 - 1)= 2 的视频为 "456"，因此返回 "456"。
> 
> videoSharingPlatform.watch(1, 0, 1);> 
> > 
>  // 与 videoId 1 关联的视频为 "456"。
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>  // 从分钟 0 到分钟 min(1,3 - 1)= 1 的视频为 "45"，因此返回 "45"。
> 
> videoSharingPlatform.like(1);> 
> > 
> > 
> > 
> // 增加与 videoId 1 相关的视频的点赞数。
> 
> videoSharingPlatform.dislike(1);> 
> > 
> > 
>  // 增加与 videoId 1 相关联的视频的不喜欢的数量。
> 
> videoSharingPlatform.dislike(1);> 
> > 
> > 
>  // 增加与 videoId 1 相关联的视频的不喜欢的数量。
> 
> videoSharingPlatform.getLikesAndDislikes(1); // 在与 videoId 1 相关的视频中有 1 个喜欢和 2 个不喜欢，因此返回[1,2]。
> 
> videoSharingPlatform.getViews(1);> 
> > 
> > 
> // 与 videoId 1 相关联的视频有 2 个观看数，因此返回2。
> 
> 

**示例  2:**

> 
> 
> 
> 
> 
> **输入**
> 
> ["VideoSharingPlatform", "remove", "watch", "like", "dislike", "getLikesAndDislikes", "getViews"]
> 
> [[], [0], [0, 0, 1], [0], [0], [0], [0]]
> 
> **输出**
> 
> [null, null, "-1", null, null, [-1], -1]
> 
> 
> 
> **解释**
> 
> VideoSharingPlatform videoSharingPlatform = new VideoSharingPlatform();
> 
> videoSharingPlatform.remove(0);> 
> > 
> > 
>   // 没有与 videoId 0 相关联的视频，所以什么都不做。
> 
> videoSharingPlatform.watch(0, 0, 1);> 
> > 
>  // 没有与 videoId 0 相关联的视频，因此返回 "-1"。
> 
> videoSharingPlatform.like(0);> 
> > 
> > 
> > 
> // 没有与 videoId 0 相关联的视频，所以什么都不做。
> 
> videoSharingPlatform.dislike(0);> 
> > 
> > 
>  // 没有与 videoId 0 相关联的视频，所以什么都不做。
> 
> videoSharingPlatform.getLikesAndDislikes(0); // 没有与 videoId 0 相关联的视频，因此返回 [-1]。
> 
> videoSharingPlatform.getViews(0);> 
> > 
> > 
> // 没有视频与 videoId 0 相关联，因此返回 -1。
> 
> 



**提示:**

  * `1 <= video.length <= 10^5`
  * 调用 `upload` 时所有 `video.length` 的总和不会超过 `10^5`
  * `video` 由数字组成
  * `0 <= videoId <= 10^5`
  * `0 <= startMinute < endMinute < 10^5`
  * `startMinute < video.length`
  * 调用  `watch` 时所有 `endMinute - startMinute` 的总和不会超过 `10^5`。
  * 所有函数 **总共  **最多调用 `10^5` 次。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1348 | 推文计数 |  |  [`设计`](/tag/design.md) [`哈希表`](/tag/hash-table.md) [`二分查找`](/tag/binary-search.md) `2+` | 🟠 | [🀄️](https://leetcode.cn/problems/tweet-counts-per-frequency) [🔗](https://leetcode.com/problems/tweet-counts-per-frequency) |
| 1472 | 设计浏览器历史记录 | [[✓]](/problem/1472.md) |  [`栈`](/tag/stack.md) [`设计`](/tag/design.md) [`数组`](/tag/array.md) `3+` | 🟠 | [🀄️](https://leetcode.cn/problems/design-browser-history) [🔗](https://leetcode.com/problems/design-browser-history) |
| 2456 | 最流行的视频创作者 |  |  [`数组`](/tag/array.md) [`哈希表`](/tag/hash-table.md) [`字符串`](/tag/string.md) `2+` | 🟠 | [🀄️](https://leetcode.cn/problems/most-popular-video-creator) [🔗](https://leetcode.com/problems/most-popular-video-creator) |
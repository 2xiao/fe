# [1532. 最近的三笔订单](https://leetcode.com/problems/the-most-recent-three-orders)

🟠 <font color=#ffb800>Medium</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`LeetCode`](https://leetcode.com/problems/the-most-recent-three-orders)

## 题目

Table: `Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id is the column with unique values for this table.
> 
> This table contains information about customers.
> 
> 



Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | cost> 
> > 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column with unique values for this table.
> 
> This table contains information about the orders made by customer_id.
> 
> Each customer has **one order per day**.
> 
> 



Write a solution to find the most recent three orders of each user. If a user
ordered less than three orders, return all of their orders.

Return the result table ordered by `customer_name` in **ascending order** and
in case of a tie by the `customer_id` in **ascending order**. If there is
still a tie, order them by `order_date` in **descending order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Customers table:
> 
> +-------------+-----------+
> 
> | customer_id | name> 
>   |
> 
> +-------------+-----------+
> 
> | 1> 
> > 
>    | Winston   |
> 
> | 2> 
> > 
>    | Jonathan  |
> 
> | 3> 
> > 
>    | Annabelle |
> 
> | 4> 
> > 
>    | Marwan> 
> |
> 
> | 5> 
> > 
>    | Khaled> 
> |
> 
> +-------------+-----------+
> 
> Orders table:
> 
> +----------+------------+-------------+------+
> 
> | order_id | order_date | customer_id | cost |
> 
> +----------+------------+-------------+------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 30   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 40   |
> 
> | 3> 
> > 
> | 2020-07-31 | 3> 
> > 
>    | 70   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 100  |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 1010 |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 102  |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 111  |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 99   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 32   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> |
> 
> +----------+------------+-------------+------+
> 
> Output: 
> 
> +---------------+-------------+----------+------------+
> 
> | customer_name | customer_id | order_id | order_date |
> 
> +---------------+-------------+----------+------------+
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 7> 
> > 
> | 2020-08-01 |
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 3> 
> > 
> | 2020-07-31 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 9> 
> > 
> | 2020-08-07 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 6> 
> > 
> | 2020-08-01 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 2> 
> > 
> | 2020-07-30 |
> 
> | Marwan> 
> > 
> | 4> 
> > 
>    | 4> 
> > 
> | 2020-07-29 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 8> 
> > 
> | 2020-08-03 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 1> 
> > 
> | 2020-07-31 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 10> 
>    | 2020-07-15 |
> 
> +---------------+-------------+----------+------------+
> 
> Explanation: 
> 
> Winston has 4 orders, we discard the order of "2020-06-10" because it is the oldest order.
> 
> Annabelle has only 2 orders, we return them.
> 
> Jonathan has exactly 3 orders.
> 
> Marwan ordered only one time.
> 
> We sort the result table by customer_name in ascending order, by customer_id in ascending order, and by order_date in descending order in case of a tie.
> 
> 



**Follow up:** Could you write a general solution for the most recent `n`
orders?


## 题目大意

表：`Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id 是该表具有唯一值的列
> 
> 该表包含消费者的信息
> 
> 



表：`Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | cost> 
> > 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id 是该表具有唯一值的列
> 
> 该表包含 id 为 customer_id 的消费者的订单信息
> 
> 每一个消费者**每天一笔订单**
> 
> 



写一个解决方案，找到每个用户的最近三笔订单。如果用户的订单少于 3 笔，则返回他的全部订单。

返回的结果按照 `customer_name` **升序  **排列。如果有相同的排名，则按照 `customer_id` **升序
**排列。如果排名还有相同，则按照 `order_date` **降序  **排列。

结果格式如下例所示：



**示例 1:**

> 
> 
> 
> 
> 
> **输入：**
> 
> Customers
> 
> +-------------+-----------+
> 
> | customer_id | name> 
>   |
> 
> +-------------+-----------+
> 
> | 1> 
> > 
>    | Winston   |
> 
> | 2> 
> > 
>    | Jonathan  |
> 
> | 3> 
> > 
>    | Annabelle |
> 
> | 4> 
> > 
>    | Marwan> 
> |
> 
> | 5> 
> > 
>    | Khaled> 
> |
> 
> +-------------+-----------+
> 
> 
> 
> Orders
> 
> +----------+------------+-------------+------+
> 
> | order_id | order_date | customer_id | cost |
> 
> +----------+------------+-------------+------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 30   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 40   |
> 
> | 3> 
> > 
> | 2020-07-31 | 3> 
> > 
>    | 70   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 100  |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 1010 |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 102  |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 111  |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 99   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 32   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> |
> 
> +----------+------------+-------------+------+
> 
> **输出：**
> 
> +---------------+-------------+----------+------------+
> 
> | customer_name | customer_id | order_id | order_date |
> 
> +---------------+-------------+----------+------------+
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 7> 
> > 
> | 2020-08-01 |
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 3> 
> > 
> | 2020-07-31 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 9> 
> > 
> | 2020-08-07 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 6> 
> > 
> | 2020-08-01 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 2> 
> > 
> | 2020-07-30 |
> 
> | Marwan> 
> > 
> | 4> 
> > 
>    | 4> 
> > 
> | 2020-07-29 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 8> 
> > 
> | 2020-08-03 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 1> 
> > 
> | 2020-07-31 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 10> 
>    | 2020-07-15 |
> 
> +---------------+-------------+----------+------------+
> 
> **解释：**
> 
> Winston 有 4 笔订单, 排除了 "2020-06-10" 的订单, 因为它是最老的订单。
> 
> Annabelle 只有 2 笔订单, 全部返回。
> 
> Jonathan 恰好有 3 笔订单。
> 
> Marwan 只有 1 笔订单。
> 
> 结果表我们按照 customer_name 升序排列，customer_id 升序排列，order_date 降序排列。
> 
> 



**进阶：**

  * 你能写出最近 `n` 笔订单的通用解决方案吗?


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 |
| :------: | :------ | :------: | :------ | :------ |
| 1549 | [每件商品的最新订单](https://leetcode.com/problems/the-most-recent-orders-for-each-product) |  |  [`数据库`](/tag/database.md) | <font color=#ffb800>Medium</font> |
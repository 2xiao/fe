# [1597. 根据中缀表达式构造二叉表达式树 🔒](https://2xiao.github.io/leetcode-js/problem/1597.html)

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`栈`](/tag/stack.md) [`树`](/tag/tree.md) [`字符串`](/tag/string.md) [`二叉树`](/tag/binary-tree.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/build-binary-expression-tree-from-infix-expression) [`LeetCode`](https://leetcode.com/problems/build-binary-expression-tree-from-infix-expression)

## 题目

A **[binary expression
tree](https://en.wikipedia.org/wiki/Binary_expression_tree)** is a kind of
binary tree used to represent arithmetic expressions. Each node of a binary
expression tree has either zero or two children. Leaf nodes (nodes with 0
children) correspond to operands (numbers), and internal nodes (nodes with 2
children) correspond to the operators `'+'` (addition), `'-'` (subtraction),
`'*'` (multiplication), and `'/'` (division).

For each internal node with operator `o`, the [**infix
expression**](https://en.wikipedia.org/wiki/Infix_notation) it represents is
`(A o B)`, where `A` is the expression the left subtree represents and `B` is
the expression the right subtree represents.

You are given a string `s`, an **infix expression** containing operands, the
operators described above, and parentheses `'('` and `')'`.

Return _any valid**binary expression tree** , whose **[in-order
traversal](https://en.wikipedia.org/wiki/Tree_traversal#In-order_\(LNR\))**
reproduces _`s` _after omitting the parenthesis from it._

**Please note that order of operations applies in**`s`**.** That is,
expressions in parentheses are evaluated first, and multiplication and
division happen before addition and subtraction.

Operands must also appear in the **same order** in both `s` and the in-order
traversal of the tree.



**Example 1:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-4.png)

> Input: s = "3*4-2*5"
> 
> Output: [-,*,*,3,4,2,5]
> 
> Explanation: The tree above is the only valid tree whose inorder traversal produces s.

**Example 2:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-2.png)

> Input: s = "2-3/(5*2)+1"
> 
> Output: [+,-,1,2,/,null,null,null,null,3,*,null,null,5,2]
> 
> Explanation: The inorder traversal of the tree above is 2-3/5*2+1 which is the same as s without the parenthesis. The tree also produces the correct result and its operands are in the same order as they appear in s.
> 
> The tree below is also a valid binary expression tree with the same inorder traversal as s, but it not a valid answer because it does not evaluate to the same value.
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-1.png)
> 
> The third tree below is also not valid. Although it produces the same result and is equivalent to the above trees, its inorder traversal does not produce s and its operands are not in the same order as s.
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-3.png)

**Example 3:**

> Input: s = "1+2+3+4+5"
> 
> Output: [+,+,5,+,4,null,null,+,3,null,null,1,2]
> 
> Explanation: The tree [+,+,5,+,+,null,null,1,2,3,4] is also one of many other valid trees.

**Constraints:**

  * `1 <= s.length <= 100`
  * `s` consists of digits and the characters `'('`, `')'`, `'+'`, `'-'`, `'*'`, and `'/'`.
  * Operands in `s` are **exactly** 1 digit.
  * It is guaranteed that `s` is a valid expression.


## 题目大意

**二叉表达式树** 是一种表达算术表达式的二叉树。二叉表达式树中的每一个节点都有零个或两个子节点。 叶节点（有 0
个子节点的节点）表示操作数，非叶节点（有 2 个子节点的节点）表示运算符： `'+'` （加）、 `'-'` （减）、 `'*'` （乘）和 `'/'`
（除）。

对于每一个运算符为 `o`
的非叶节点，对应的**[中缀表达式](http://baike.baidu.com/item/中缀表达式/2725244?fr=aladdin)** 为
`(A o B)`，其中 `A` 是左子树所表达的表达式， `B` 是右子树所表达的表达式。

给定一个**中缀表达式** 字符串 `s`，其中包含操作数、上面提到的运算符，以及括号 `'('` 与 `')'` 。

返回一个有效的**二叉表达式树** ，其
[**中序遍历**](http://baike.baidu.com/item/中序遍历/757281?fr=aladdin) 序列对应表达式 `s`
消除括号后的序列（详情参见下面的示例） _。_

**注意，表达式的一般解析顺序适用于  **`s`，即优先解析括号内的表达式，然后解析乘除法，最后解析加减法。

同时，操作数在 `s` 和树的中序遍历中 **出现顺序相同** 。



**示例 1：**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-4.png)

> 
> 
> 
> 
> 
> **输入：** s = "3*4-2*5"
> 
> **输出：**[-,*,*,3,4,2,5]
> 
> **解释：** 上面是唯一一种有效的二叉表达式树，其中序遍历生成 s 。
> 
> 

**示例 2：**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-2.png)

> 
> 
> 
> 
> 
> **输入：** s = "2-3/(5*2)+1"
> 
> **输出：**[+,-,1,2,/,null,null,null,null,3,*,null,null,5,2]
> 
> **解释：** 上面的树的中序遍历为 2-3/5*2+1 ，与 s 消除括号后相同。该树还会生成正确的结果，其操作数的顺序与 s 中出现的顺序相同。
> 
> 下面的树也是一个有效的二叉表达式树，具有与 s 相同的中序遍历，但它不是一个有效的答案，因为它的求值结果不同。
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-1.png)
> 
> 下面的树也是无效的。尽管它的计算结果相等并与上述树等效，但其中序遍历不会产生 s ，并且其操作数与 s 中的顺序也不相同。
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-3.png)
> 
> 

**示例 3：**

> 
> 
> 
> 
> 
> **输入：** s = "1+2+3+4+5"
> 
> **输出：**[+,+,5,+,4,null,null,+,3,null,null,1,2]
> 
> **解释：** 二叉树 [+,+,5,+,+,null,null,1,2,3,4] 也是诸多有效的二叉表达式树之一。



**提示:**

  * `1 <= s.length <= 100`
  * `s` 中包含数字和字符 `'('`、 `')'`、`'+'`、 `'-'`、 `'*'`、 `'/'` 。
  * `s` 中的操作数 **恰好** 是一位数字。
  * 题目数据保证 `s` 是一个有效的表达式。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 |
| :------: | :------ | :------: | :------ | :------ |
| 772 | [基本计算器 III 🔒](https://leetcode.com/problems/basic-calculator-iii) | [[✓]](/problem/0772.md) |  [`栈`](/tag/stack.md) [`递归`](/tag/recursion.md) [`数学`](/tag/math.md) `1+` | <font color=#ff334b>Hard</font> |
| 1612 | [检查两棵二叉表达式树是否等价 🔒](https://leetcode.com/problems/check-if-two-expression-trees-are-equivalent) |  |  [`树`](/tag/tree.md) [`深度优先搜索`](/tag/depth-first-search.md) [`哈希表`](/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> |
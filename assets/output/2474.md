---
title: 2474. 购买量严格增加的客户 🔒
description: LeetCode,2474. 购买量严格增加的客户 🔒,购买量严格增加的客户,Customers With Strictly Increasing Purchases,解题思路,数据库
keywords:
  - LeetCode
  - 2474. 购买量严格增加的客户 🔒
  - 购买量严格增加的客户
  - Customers With Strictly Increasing Purchases
  - 解题思路
  - 数据库
---

# 2474. 购买量严格增加的客户 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/customers-with-strictly-increasing-purchases) [`LeetCode`](https://leetcode.com/problems/customers-with-strictly-increasing-purchases)

## 题目

Table: `Orders`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | order_id> 
>  | int  |
> 
> | customer_id  | int  |
> 
> | order_date   | date |
> 
> | price> 
> > 
> | int  |
> 
> +--------------+------+
> 
> order_id is the column with unique values for this table.
> 
> Each row contains the id of an order, the id of customer that ordered it, the date of the order, and its price.
> 
> 



Write a solution to report the IDs of the customers with the **total
purchases** strictly increasing yearly.

  * The **total purchases** of a customer in one year is the sum of the prices of their orders in that year. If for some year the customer did not make any order, we consider the total purchases `0`.
  * The first year to consider for each customer is the year of their **first order**.
  * The last year to consider for each customer is the year of their **last order**.

Return the result table **in any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Orders table:
> 
> +----------+-------------+------------+-------+
> 
> | order_id | customer_id | order_date | price |
> 
> +----------+-------------+------------+-------+
> 
> | 1> 
> > 
> | 1> 
> > 
>    | 2019-07-01 | 1100  |
> 
> | 2> 
> > 
> | 1> 
> > 
>    | 2019-11-01 | 1200  |
> 
> | 3> 
> > 
> | 1> 
> > 
>    | 2020-05-26 | 3000  |
> 
> | 4> 
> > 
> | 1> 
> > 
>    | 2021-08-31 | 3100  |
> 
> | 5> 
> > 
> | 1> 
> > 
>    | 2022-12-07 | 4700  |
> 
> | 6> 
> > 
> | 2> 
> > 
>    | 2015-01-01 | 700   |
> 
> | 7> 
> > 
> | 2> 
> > 
>    | 2017-11-07 | 1000  |
> 
> | 8> 
> > 
> | 3> 
> > 
>    | 2017-01-01 | 900   |
> 
> | 9> 
> > 
> | 3> 
> > 
>    | 2018-11-07 | 900   |
> 
> +----------+-------------+------------+-------+
> 
> Output: 
> 
> +-------------+
> 
> | customer_id |
> 
> +-------------+
> 
> | 1> 
> > 
>    |
> 
> +-------------+
> 
> Explanation: 
> 
> Customer 1: The first year is 2019 and the last year is 2022
  > - 2019: 1100 + 1200 = 2300
  > - 2020: 3000
  > - 2021: 3100
  > - 2022: 4700
> 
>   We can see that the total purchases are strictly increasing yearly, so we include customer 1 in the answer.
> 
> 
> 
> Customer 2: The first year is 2015 and the last year is 2017
  > - 2015: 700
  > - 2016: 0
  > - 2017: 1000
> 
>   We do not include customer 2 in the answer because the total purchases are not strictly increasing. Note that customer 2 did not make any purchases in 2016.
> 
> 
> 
> Customer 3: The first year is 2017, and the last year is 2018
  > - 2017: 900
  > - 2018: 900
> 
>  We do not include customer 3 in the answer because the total purchases are not strictly increasing.
> 
> 


## 题目大意

表: `Orders`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | order_id> 
>  | int  |
> 
> | customer_id  | int  |
> 
> | order_date   | date |
> 
> | price> 
> > 
> | int  |
> 
> +--------------+------+
> 
> order_id 是该表的主键。
> 
> 每行包含订单的 id、订购该订单的客户 id、订单日期和价格。
> 
> 



编写一个 SQL 查询，报告 **总购买量  **每年严格增加的客户 id。

  * 客户在一年内的 **总购买量  **是该年订单价格的总和。如果某一年客户没有下任何订单，我们认为总购买量为 `0`。
  * 对于每个客户，要考虑的第一个年是他们 **第一次下单  **的年份。
  * 对于每个客户，要考虑的最后一年是他们 **最后一次下单  **的年份。

以 **任意顺序  **返回结果表。

查询结果格式如下所示。



**示例 1:**

> 
> 
> 
> 
> 
> **输入:** 
> 
> Orders 表:
> 
> +----------+-------------+------------+-------+
> 
> | order_id | customer_id | order_date | price |
> 
> +----------+-------------+------------+-------+
> 
> | 1> 
> > 
> | 1> 
> > 
>    | 2019-07-01 | 1100  |
> 
> | 2> 
> > 
> | 1> 
> > 
>    | 2019-11-01 | 1200  |
> 
> | 3> 
> > 
> | 1> 
> > 
>    | 2020-05-26 | 3000  |
> 
> | 4> 
> > 
> | 1> 
> > 
>    | 2021-08-31 | 3100  |
> 
> | 5> 
> > 
> | 1> 
> > 
>    | 2022-12-07 | 4700  |
> 
> | 6> 
> > 
> | 2> 
> > 
>    | 2015-01-01 | 700   |
> 
> | 7> 
> > 
> | 2> 
> > 
>    | 2017-11-07 | 1000  |
> 
> | 8> 
> > 
> | 3> 
> > 
>    | 2017-01-01 | 900   |
> 
> | 9> 
> > 
> | 3> 
> > 
>    | 2018-11-07 | 900   |
> 
> +----------+-------------+------------+-------+
> 
> **输出:** 
> 
> +-------------+
> 
> | customer_id |
> 
> +-------------+
> 
> | 1> 
> > 
>    |
> 
> +-------------+
> 
> **解释:** 
> 
> 客户 1: 第一年是 2019 年，最后一年是 2022 年
  > - 2019: 1100 + 1200 = 2300
  > - 2020: 3000
  > - 2021: 3100
  > - 2022: 4700
> 
>   我们可以看到总购买量每年都在严格增加，所以我们在答案中包含了客户 1。
> 
> 
> 
> 客户 2: 第一年是2015年，最后一年是2017年
  > - 2015: 700
  > - 2016: 0
  > - 2017: 1000
> 
>   我们没有把客户 2 包括在答案中，因为总的购买量并没有严格地增加。请注意，客户 2 在 2016 年没有购买任何物品。
> 
> 
> 
> 客户 3: 第一年是 2017 年，最后一年是 2018 年
  > - 2017: 900
  > - 2018: 900


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1225 | 报告系统状态的连续日期 🔒 |  |  [`数据库`](/tag/database.md) | 🔴 | [🀄️](https://leetcode.cn/problems/report-contiguous-dates) [🔗](https://leetcode.com/problems/report-contiguous-dates) |
| 1285 | 找到连续区间的开始和结束数字 🔒 |  |  [`数据库`](/tag/database.md) | 🟠 | [🀄️](https://leetcode.cn/problems/find-the-start-and-end-number-of-continuous-ranges) [🔗](https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges) |
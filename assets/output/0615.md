---
title: 615. 平均工资：部门与公司比较 🔒
description: LeetCode,615. 平均工资：部门与公司比较 🔒,平均工资：部门与公司比较,Average Salary: Departments VS Company,解题思路,数据库
keywords:
  - LeetCode
  - 615. 平均工资：部门与公司比较 🔒
  - 平均工资：部门与公司比较
  - Average Salary: Departments VS Company
  - 解题思路
  - 数据库
---

# 615. 平均工资：部门与公司比较 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/average-salary-departments-vs-company) [`LeetCode`](https://leetcode.com/problems/average-salary-departments-vs-company)

## 题目

Table: `Salary`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | id> 
> > 
>   | int  |
> 
> | employee_id | int  |
> 
> | amount> 
>   | int  |
> 
> | pay_date> 
> | date |
> 
> +-------------+------+
> 
> In SQL, id is the primary key column for this table.
> 
> Each row of this table indicates the salary of an employee in one month.
> 
> employee_id is a foreign key (reference column) from the Employee table.
> 
> 



Table: `Employee`

> 
> 
> 
> 
> 
> +---------------+------+
> 
> | Column Name   | Type |
> 
> +---------------+------+
> 
> | employee_id   | int  |
> 
> | department_id | int  |
> 
> +---------------+------+
> 
> In SQL, employee_id is the primary key column for this table.
> 
> Each row of this table indicates the department of an employee.
> 
> 



Find the comparison result **(higher/lower/same)** of the average salary of
employees in a department to the company's average salary.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Salary table:
> 
> +----+-------------+--------+------------+
> 
> | id | employee_id | amount | pay_date   |
> 
> +----+-------------+--------+------------+
> 
> | 1  | 1> 
> > 
>    | 9000   | 2017/03/31 |
> 
> | 2  | 2> 
> > 
>    | 6000   | 2017/03/31 |
> 
> | 3  | 3> 
> > 
>    | 10000  | 2017/03/31 |
> 
> | 4  | 1> 
> > 
>    | 7000   | 2017/02/28 |
> 
> | 5  | 2> 
> > 
>    | 6000   | 2017/02/28 |
> 
> | 6  | 3> 
> > 
>    | 8000   | 2017/02/28 |
> 
> +----+-------------+--------+------------+
> 
> Employee table:
> 
> +-------------+---------------+
> 
> | employee_id | department_id |
> 
> +-------------+---------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
> > 
>  |
> 
> | 2> 
> > 
>    | 2> 
> > 
> > 
>  |
> 
> | 3> 
> > 
>    | 2> 
> > 
> > 
>  |
> 
> +-------------+---------------+
> 
> Output: 
> 
> +-----------+---------------+------------+
> 
> | pay_month | department_id | comparison |
> 
> +-----------+---------------+------------+
> 
> | 2017-02   | 1> 
> > 
> > 
>  | same> 
>    |
> 
> | 2017-03   | 1> 
> > 
> > 
>  | higher> 
>  |
> 
> | 2017-02   | 2> 
> > 
> > 
>  | same> 
>    |
> 
> | 2017-03   | 2> 
> > 
> > 
>  | lower> 
>   |
> 
> +-----------+---------------+------------+
> 
> Explanation: 
> 
> In March, the company's average salary is (9000+6000+10000)/3 = 8333.33...
> 
> The average salary for department '1' is 9000, which is the salary of employee_id '1' since there is only one employee in this department. So the comparison result is 'higher' since 9000 > 8333.33 obviously.
> 
> The average salary of department '2' is (6000 + 10000)/2 = 8000, which is the average of employee_id '2' and '3'. So the comparison result is 'lower' since 8000 < 8333.33.
> 
> 
> 
> With he same formula for the average salary comparison in February, the result is 'same' since both the department '1' and '2' have the same average salary with the company, which is 7000.
> 
> 


## 题目大意

表：`Salary`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | 列名> 
> > 
> | 类型 |
> 
> +-------------+------+
> 
> | id> 
> > 
>   | int  |
> 
> | employee_id | int  |
> 
> | amount> 
>   | int  |
> 
> | pay_date> 
> | date |
> 
> +-------------+------+
> 
> 在 SQL 中，id 是该表的主键列。
> 
> 该表的每一行表示一个员工一个月的薪资。
> 
> employee_id 是来自 Employee 表的外键（reference 列）。



表： `Employee`

> 
> 
> 
> 
> 
> +---------------+------+
> 
> | 列名> 
> > 
>   | 类型 |
> 
> +---------------+------+
> 
> | employee_id   | int  |
> 
> | department_id | int  |
> 
> +---------------+------+
> 
> 在 SQL 中，employee_id 是该表的主键列。
> 
> 该表的每一行表示一个员工所属的部门。



找出各个部门员工的平均薪资与公司平均薪资之间的比较结果（**更高 / 更低 / 相同** ）。

以 **任意顺序** 返回结果表。

结果格式如下所示。



**示例 1：**

> 
> 
> 
> 
> 
> **输入：**
> 
> Salary 表:
> 
> +----+-------------+--------+------------+
> 
> | id | employee_id | amount | pay_date   |
> 
> +----+-------------+--------+------------+
> 
> | 1  | 1> 
> > 
>    | 9000   | 2017/03/31 |
> 
> | 2  | 2> 
> > 
>    | 6000   | 2017/03/31 |
> 
> | 3  | 3> 
> > 
>    | 10000  | 2017/03/31 |
> 
> | 4  | 1> 
> > 
>    | 7000   | 2017/02/28 |
> 
> | 5  | 2> 
> > 
>    | 6000   | 2017/02/28 |
> 
> | 6  | 3> 
> > 
>    | 8000   | 2017/02/28 |
> 
> +----+-------------+--------+------------+
> 
> Employee 表:
> 
> +-------------+---------------+
> 
> | employee_id | department_id |
> 
> +-------------+---------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
> > 
>  |
> 
> | 2> 
> > 
>    | 2> 
> > 
> > 
>  |
> 
> | 3> 
> > 
>    | 2> 
> > 
> > 
>  |
> 
> +-------------+---------------+
> 
> **输出：**
> 
> +-----------+---------------+------------+
> 
> | pay_month | department_id | comparison |
> 
> +-----------+---------------+------------+
> 
> | 2017-02   | 1> 
> > 
> > 
>  | same> 
>    |
> 
> | 2017-03   | 1> 
> > 
> > 
>  | higher> 
>  |
> 
> | 2017-02   | 2> 
> > 
> > 
>  | same> 
>    |
> 
> | 2017-03   | 2> 
> > 
> > 
>  | lower> 
>   |
> 
> +-----------+---------------+------------+
> 
> **解释：** 在三月，公司的平均工资是 (9000+6000+10000)/3 = 8333.33...
> 
> 部门 '1' 的平均薪资是 9000，因为该部门只有一个员工，其员工号为 '1'。因为 9000 > 8333.33，所以比较结果为 'higher'
> 
> 部门 '2' 的平均薪资是（6000 + 10000）/ 2 = 8000，该平均薪资是员工号 '2' 和 '3' 的薪资的平均值。因为 8000 < 8333.33，比较结果为 'lower'。
> 
> 
> 
> 根据同样的公式，对于二月份的平均薪资比较，结果为 'same'，因为部门 '1' 和 '2' 都与公司的平均薪资相同，即为 7000。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 1501 | 可以放心投资的国家 🔒 |  |  [`数据库`](/tag/database.md) | <font color=#ffb800>Medium</font> | [🀄️](https://leetcode.cn/problems/countries-you-can-safely-invest-in) [🔗](https://leetcode.com/problems/countries-you-can-safely-invest-in) |
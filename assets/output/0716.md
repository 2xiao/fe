---
title: 716. 最大栈 🔒
description: LeetCode,716. 最大栈 🔒,最大栈,Max Stack,解题思路,栈,设计,链表,双向链表,有序集合
keywords:
  - LeetCode
  - 716. 最大栈 🔒
  - 最大栈
  - Max Stack
  - 解题思路
  - 栈
  - 设计
  - 链表
  - 双向链表
  - 有序集合
---

# 716. 最大栈 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`栈`](/tag/stack.md) [`设计`](/tag/design.md) [`链表`](/tag/linked-list.md) [`双向链表`](/tag/doubly-linked-list.md) [`有序集合`](/tag/ordered-set.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/max-stack) [`LeetCode`](https://leetcode.com/problems/max-stack)

## 题目

Design a max stack data structure that supports the stack operations and
supports finding the stack's maximum element.

Implement the `MaxStack` class:

  * `MaxStack()` Initializes the stack object.
  * `void push(int x)` Pushes element `x` onto the stack.
  * `int pop()` Removes the element on top of the stack and returns it.
  * `int top()` Gets the element on the top of the stack without removing it.
  * `int peekMax()` Retrieves the maximum element in the stack without removing it.
  * `int popMax()` Retrieves the maximum element in the stack and removes it. If there is more than one maximum element, only remove the **top-most** one.

You must come up with a solution that supports `O(1)` for each `top` call and
`O(logn)` for each other call.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["MaxStack", "push", "push", "push", "top", "popMax", "top", "peekMax", "pop", "top"]
> 
> [[], [5], [1], [5], [], [], [], [], [], []]
> 
> **Output**
> 
> [null, null, null, null, 5, 5, 1, 5, 1, 5]
> 
> 
> 
> **Explanation**
> 
> MaxStack stk = new MaxStack();
> 
> stk.push(5);   // [**_5_**] the top of the stack and the maximum number is 5.
> 
> stk.push(1);   // [_5_ , **1**] the top of the stack is 1, but the maximum is 5.
> 
> stk.push(5);   // [5, 1, **_5_**] the top of the stack is 5, which is also the maximum, because it is the top most one.
> 
> stk.top();> 
>  // return 5, [5, 1, **_5_**] the stack did not change.
> 
> stk.popMax();  // return 5, [_5_ , **1**] the stack is changed now, and the top is different from the max.
> 
> stk.top();> 
>  // return 1, [_5_ , **1**] the stack did not change.
> 
> stk.peekMax(); // return 5, [_5_ , **1**] the stack did not change.
> 
> stk.pop();> 
>  // return 1, [**_5_**] the top of the stack and the max element is now 5.
> 
> stk.top();> 
>  // return 5, [**_5_**] the stack did not change.

**Constraints:**

  * `-10^7 <= x <= 10^7`
  * At most `10^5` calls will be made to `push`, `pop`, `top`, `peekMax`, and `popMax`.
  * There will be **at least one element** in the stack when `pop`, `top`, `peekMax`, or `popMax` is called.


## 题目大意

设计一个最大栈数据结构，既支持栈操作，又支持查找栈中最大元素。

实现 `MaxStack` 类：

  * `MaxStack()` 初始化栈对象
  * `void push(int x)` 将元素 x 压入栈中。
  * `int pop()` 移除栈顶元素并返回这个元素。
  * `int top()` 返回栈顶元素，无需移除。
  * `int peekMax()` 检索并返回栈中最大元素，无需移除。
  * `int popMax()` 检索并返回栈中最大元素，并将其移除。如果有多个最大元素，只要移除 **最靠近栈顶** 的那个。

**示例：**

> 
> 
> 
> 
> 
> **输入**
> 
> ["MaxStack", "push", "push", "push", "top", "popMax", "top", "peekMax", "pop", "top"]
> 
> [[], [5], [1], [5], [], [], [], [], [], []]
> 
> **输出**
> 
> [null, null, null, null, 5, 5, 1, 5, 1, 5]
> 
> 
> 
> **解释**
> 
> MaxStack stk = new MaxStack();
> 
> stk.push(5);   // [**5**] - 5 既是栈顶元素，也是最大元素
> 
> stk.push(1);   // [**5** , **1**] - 栈顶元素是 1，最大元素是 5
> 
> stk.push(5);   // [5, 1, **5**] - 5 既是栈顶元素，也是最大元素
> 
> stk.top();> 
>  // 返回 5，[5, 1, **5**] - 栈没有改变
> 
> stk.popMax();  // 返回 5，[**5** , **1**] - 栈发生改变，栈顶元素不再是最大元素
> 
> stk.top();> 
>  // 返回 1，[**5** , **1**] - 栈没有改变
> 
> stk.peekMax(); // 返回 5，[**5** , **1**] - 栈没有改变
> 
> stk.pop();> 
>  // 返回 1，[**5**] - 此操作后，5 既是栈顶元素，也是最大元素
> 
> stk.top();> 
>  // 返回 5，[**5**] - 栈没有改变
> 
> 

**提示：**

  * `-10^7 <= x <= 10^7`
  * 最多调用 `10^4` 次 `push`、`pop`、`top`、`peekMax` 和 `popMax`
  * 调用 `pop`、`top`、`peekMax` 或 `popMax` 时，栈中 **至少存在一个元素**

**进阶：**

  * 试着设计解决方案：调用 `top` 方法的时间复杂度为 `O(1)` ，调用其他方法的时间复杂度为 `O(logn)` 。 


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 155 | 最小栈 | [[✓]](/problem/0155.md) |  [`栈`](/tag/stack.md) [`设计`](/tag/design.md) | <font color=#ffb800>Medium</font> | [🀄️](https://leetcode.cn/problems/min-stack) [🔗](https://leetcode.com/problems/min-stack) |
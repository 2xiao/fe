# [1225. 报告系统状态的连续日期](https://leetcode.com/problems/report-contiguous-dates)

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`LeetCode`](https://leetcode.com/problems/report-contiguous-dates)

## 题目

Table: `Failed`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | fail_date> 
> | date> 
> |
> 
> +--------------+---------+
> 
> fail_date is the primary key (column with unique values) for this table.
> 
> This table contains the days of failed tasks.
> 
> 



Table: `Succeeded`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | success_date | date> 
> |
> 
> +--------------+---------+
> 
> success_date is the primary key (column with unique values) for this table.
> 
> This table contains the days of succeeded tasks.
> 
> 



A system is running one task **every day**. Every task is independent of the
previous tasks. The tasks can fail or succeed.

Write a solution to report the `period_state` for each continuous interval of
days in the period from `2019-01-01` to `2019-12-31`.

`period_state` is _'_`failed'`__ if tasks in this interval failed or
`'succeeded'` if tasks in this interval succeeded. Interval of days are
retrieved as `start_date` and `end_date.`

Return the result table ordered by `start_date`.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Failed table:
> 
> +-------------------+
> 
> | fail_date> 
> > 
>  |
> 
> +-------------------+
> 
> | 2018-12-28> 
> > 
> |
> 
> | 2018-12-29> 
> > 
> |
> 
> | 2019-01-04> 
> > 
> |
> 
> | 2019-01-05> 
> > 
> |
> 
> +-------------------+
> 
> Succeeded table:
> 
> +-------------------+
> 
> | success_date> 
>   |
> 
> +-------------------+
> 
> | 2018-12-30> 
> > 
> |
> 
> | 2018-12-31> 
> > 
> |
> 
> | 2019-01-01> 
> > 
> |
> 
> | 2019-01-02> 
> > 
> |
> 
> | 2019-01-03> 
> > 
> |
> 
> | 2019-01-06> 
> > 
> |
> 
> +-------------------+
> 
> Output: 
> 
> +--------------+--------------+--------------+
> 
> | period_state | start_date   | end_date> 
>  |
> 
> +--------------+--------------+--------------+
> 
> | succeeded> 
> | 2019-01-01   | 2019-01-03   |
> 
> | failed> 
>    | 2019-01-04   | 2019-01-05   |
> 
> | succeeded> 
> | 2019-01-06   | 2019-01-06   |
> 
> +--------------+--------------+--------------+
> 
> Explanation: 
> 
> The report ignored the system state in 2018 as we care about the system in the period 2019-01-01 to 2019-12-31.
> 
> From 2019-01-01 to 2019-01-03 all tasks succeeded and the system state was "succeeded".
> 
> From 2019-01-04 to 2019-01-05 all tasks failed and the system state was "failed".
> 
> From 2019-01-06 to 2019-01-06 all tasks succeeded and the system state was "succeeded".
> 
> 


## 题目大意

表：`Failed`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | fail_date> 
> | date> 
> |
> 
> +--------------+---------+
> 
> 该表主键为 fail_date (具有唯一值的列)。
> 
> 该表包含失败任务的天数.
> 
> 



表： `Succeeded`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | success_date | date> 
> |
> 
> +--------------+---------+
> 
> 该表主键为 success_date (具有唯一值的列)。
> 
> 该表包含成功任务的天数.
> 
> 



系统 **每天** 运行一个任务。每个任务都独立于先前的任务。任务的状态可以是失败或是成功。

编写解决方案找出 **2019-01-01**  到 **2019-12-31** 期间任务连续同状态 `period_state`
的起止日期（`start_date` 和 `end_date`）。即如果任务失败了，就是失败状态的起止日期，如果任务成功了，就是成功状态的起止日期。

最后结果按照起始日期 `start_date` 排序

返回结果样例如下所示:



**示例 1：**

> 
> 
> 
> 
> 
> **输入：**
> 
> Failed table:
> 
> +-------------------+
> 
> | fail_date> 
> > 
>  |
> 
> +-------------------+
> 
> | 2018-12-28> 
> > 
> |
> 
> | 2018-12-29> 
> > 
> |
> 
> | 2019-01-04> 
> > 
> |
> 
> | 2019-01-05> 
> > 
> |
> 
> +-------------------+
> 
> Succeeded table:
> 
> +-------------------+
> 
> | success_date> 
>   |
> 
> +-------------------+
> 
> | 2018-12-30> 
> > 
> |
> 
> | 2018-12-31> 
> > 
> |
> 
> | 2019-01-01> 
> > 
> |
> 
> | 2019-01-02> 
> > 
> |
> 
> | 2019-01-03> 
> > 
> |
> 
> | 2019-01-06> 
> > 
> |
> 
> +-------------------+
> 
> **输出：**
> 
> +--------------+--------------+--------------+
> 
> | period_state | start_date   | end_date> 
>  |
> 
> +--------------+--------------+--------------+
> 
> | succeeded> 
> | 2019-01-01   | 2019-01-03   |
> 
> | failed> 
>    | 2019-01-04   | 2019-01-05   |
> 
> | succeeded> 
> | 2019-01-06   | 2019-01-06   |
> 
> +--------------+--------------+--------------+
> 
> **解释：**
> 
> 结果忽略了 2018 年的记录，因为我们只关心从 2019-01-01 到 2019-12-31 的记录
> 
> 从 2019-01-01 到 2019-01-03 所有任务成功，系统状态为 "succeeded"。
> 
> 从 2019-01-04 到 2019-01-05 所有任务失败，系统状态为 "failed"。
> 
> 从 2019-01-06 到 2019-01-06 所有任务成功，系统状态为 "succeeded"。
> 
> 


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 |
| :------: | :------ | :------: | :------ | :------ |
| 1285 | [找到连续区间的开始和结束数字](https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges) |  |  [`数据库`](/tag/database.md) | <font color=#ffb800>Medium</font> |
| 1613 | [找到遗失的ID](https://leetcode.com/problems/find-the-missing-ids) |  |  [`数据库`](/tag/database.md) | <font color=#ffb800>Medium</font> |
| 2474 | [购买量严格增加的客户](https://leetcode.com/problems/customers-with-strictly-increasing-purchases) |  |  [`数据库`](/tag/database.md) | <font color=#ff334b>Hard</font> |
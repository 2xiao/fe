---
title: 2253. 动态取消表的旋转 🔒
description: LeetCode,2253. 动态取消表的旋转 🔒,动态取消表的旋转,Dynamic Unpivoting of a Table,解题思路,数据库
keywords:
  - LeetCode
  - 2253. 动态取消表的旋转 🔒
  - 动态取消表的旋转
  - Dynamic Unpivoting of a Table
  - 解题思路
  - 数据库
---

# 2253. 动态取消表的旋转 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/dynamic-unpivoting-of-a-table) [`LeetCode`](https://leetcode.com/problems/dynamic-unpivoting-of-a-table)

## 题目

Table: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store_name1 | int> 
>  |
> 
> | store_name2 | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> | store_namen | int> 
>  |
> 
> +-------------+---------+
> 
> product_id is the primary key for this table.
> 
> Each row in this table indicates the product's price in n different stores.
> 
> If the product is not available in a store, the price will be null in that store's column.
> 
> The names of the stores may change from one testcase to another. There will be at least 1 store and at most 30 stores.
> 
> 



**Important note:** This problem targets those who have a good experience with
SQL. If you are a beginner, we recommend that you skip it for now.

Implement the procedure `UnpivotProducts` to reorganize the `Products` table
so that each row has the id of one product, the name of a store where it is
sold, and its price in that store. If a product is not available in a store,
do **not** include a row with that `product_id` and `store` combination in the
result table. There should be three columns: `product_id`, `store`, and
`price`.

The procedure should return the table after reorganizing it.

Return the result table in **any order**.

The query result format is in the following example.



**Example 1:**

> Input: 
> 
> Products table:
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> Output: 
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> Explanation: 
> 
> Product 1 is sold in LC_Store and Shop with prices of 100 and 110 respectively.
> 
> Product 2 is sold in Nozama and Souq with prices of 200 and 190.
> 
> Product 3 is sold in Shop and Souq with prices of 1000 and 1900.
> 
> 


## 题目大意

表: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store_name1 | int> 
>  |
> 
> | store_name2 | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> | store_namen | int> 
>  |
> 
> +-------------+---------+
> 
> product_id 是该表的主键。
> 
> 该表中的每一行都表示该商品在 n 个不同商店中的价格。
> 
> 如果商店中没有该商品，则该商店列中的价格将为 null。
> 
> 不同测试用例的商店名称可能会不同。至少有1家店，最多30家店。
> 
> 



**重要提示:** 这个问题针对的是那些对 SQL 有丰富经验的人。如果你是初学者，我们建议你现在跳过它。

实现 `UnpivotProducts` 过程来重新组织 `Products` 表，使每一行都有一个产品的
id、销售该商品的商店名称以及该商品在该商店中的价格。如果某个商品在某个商店中不可用，则不要在结果表中包含该 `product_id` 和 `store`
组合的行。结果应该有三列:`product_id`、`store` 和 `price`。

过程应该在重新组织表之后返回它。

以 **任意顺序  **返回结果表。

查询结果格式如下所示。



**示例 1:**

> 
> 
> 
> 
> 
> **输入:** 
> 
> Products 表:
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> **输出:** 
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> **解释:** 
> 
> 商品 1 在 LC_Store 和 Shop 销售，价格分别为 100 和 110。
> 
> 商品 2 在 Nozama 和 Souq 销售，价格分别为 200 和 190。
> 
> 商品 3 在 Shop 和 Souq 出售，价格分别为 1000 和 1900。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1795 | 每个产品在不同商店的价格 |  |  [`数据库`](/tag/database.md) | 🟢 | [🀄️](https://leetcode.cn/problems/rearrange-products-table) [🔗](https://leetcode.com/problems/rearrange-products-table) |
import{_ as p,r as l,o as r,c as u,a as t,b as n,d as e,w as a,f as d,e as i}from"./app-5LzGvT4H.js";const m={},h=t("h1",{id:"_2637-有时间限制的-promise-对象",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#_2637-有时间限制的-promise-对象","aria-hidden":"true"},"#"),n(" 2637. 有时间限制的 Promise 对象")],-1),_={href:"https://leetcode.cn/problems/promise-time-limit",target:"_blank",rel:"noopener noreferrer"},k=t("code",null,"力扣",-1),f={href:"https://leetcode.com/problems/promise-time-limit",target:"_blank",rel:"noopener noreferrer"},g=t("code",null,"LeetCode",-1),v=i('<h2 id="题目" tabindex="-1"><a class="header-anchor" href="#题目" aria-hidden="true">#</a> 题目</h2><p>Given an asynchronous function <code>fn</code> and a time <code>t</code> in milliseconds, return a new <strong>time limited</strong> version of the input function. <code>fn</code> takes arguments provided to the **time limited **function.</p><p>The <strong>time limited</strong> function should follow these rules:</p><ul><li>If the <code>fn</code> completes within the time limit of <code>t</code> milliseconds, the <strong>time limited</strong> function should resolve with the result.</li><li>If the execution of the <code>fn</code> exceeds the time limit, the <strong>time limited</strong> function should reject with the string <code>&quot;Time Limit Exceeded&quot;</code>.</li></ul><p><strong>Example 1:</strong></p>',5),b=t("blockquote",null,[t("p",null,"Input:"),t("p",null,"fn = async (n) => {"),t("p",null,"await new Promise(res => setTimeout(res, 100));"),t("p",null,"return n * n;"),t("p",null,"}"),t("p",null,"inputs = [5]"),t("p",null,"t = 50"),t("p",{"rejected:TimeLimitExceeded,time:50":""},"Output:"),t("p",null,"Explanation:"),t("p",null,"const limited = timeLimit(fn, t)"),t("p",null,"const start = performance.now()"),t("p",null,"let result;"),t("p",null,"try {"),t("p",null,"const res = await limited(...inputs)"),t("p",null,'result = {"resolved": res, "time": Math.floor(performance.now() - start)};'),t("p",null,"} catch (err) {"),t("p",null,'result = {"rejected": err, "time": Math.floor(performance.now() - start)};'),t("p",null,"}"),t("p",null,"console.log(result) // Output"),t("p",null,"The provided function is set to resolve after 100ms. However, the time limit is set to 50ms. It rejects at t=50ms because the time limit was reached.")],-1),x=t("p",null,[t("strong",null,"Example 2:")],-1),y=t("blockquote",null,[t("p",null,"Input:"),t("p",null,"fn = async (n) => {"),t("p",null,"await new Promise(res => setTimeout(res, 100));"),t("p",null,"return n * n;"),t("p",null,"}"),t("p",null,"inputs = [5]"),t("p",null,"t = 150"),t("p",{"resolved:25,time:100":""},"Output:"),t("p",null,"Explanation:"),t("p",null,"The function resolved 5 * 5 = 25 at t=100ms. The time limit is never reached.")],-1),w=t("p",null,[t("strong",null,"Example 3:")],-1),T=t("blockquote",null,[t("p",null,"Input:"),t("p",null,"fn = async (a, b) => {"),t("p",null,"await new Promise(res => setTimeout(res, 120));"),t("p",null,"return a + b;"),t("p",null,"}"),t("p",null,"inputs = [5,10]"),t("p",null,"t = 150"),t("p",{"resolved:15,time:120":""},"Output:"),t("p",null,"Explanation:"),t("p",null,"​​​​The function resolved 5 + 10 = 15 at t=120ms. The time limit is never reached.")],-1),E=t("p",null,[t("strong",null,"Example 4:")],-1),L=t("blockquote",null,[t("p",null,"Input:"),t("p",null,"fn = async () => {"),t("p",null,'throw "Error";'),t("p",null,"}"),t("p",null,"inputs = []"),t("p",null,"t = 1000"),t("p",{"rejected:Error,time:0":""},"Output:"),t("p",null,"Explanation:"),t("p",null,"The function immediately throws an error.")],-1),q=i(`<p><strong>Constraints:</strong></p><ul><li><code>0 &lt;= inputs.length &lt;= 10</code></li><li><code>0 &lt;= t &lt;= 1000</code></li><li><code>fn</code> returns a promise</li></ul><h2 id="题目大意" tabindex="-1"><a class="header-anchor" href="#题目大意" aria-hidden="true">#</a> 题目大意</h2><p>请你编写一个函数，它接受一个异步函数 <code>fn</code> 和一个以毫秒为单位的时间 <code>t</code>。它应根据限时函数返回一个有 <strong>限时</strong> 效果的函数。函数 <code>fn</code> 接受提供给 <strong>限时</strong> 函数的参数。</p><p><strong>限时</strong> 函数应遵循以下规则：</p><ul><li>如果 <code>fn</code> 在 <code>t</code> 毫秒的时间限制内完成，<strong>限时</strong> 函数应返回结果。</li><li>如果 <code>fn</code> 的执行超过时间限制，<strong>限时</strong> 函数应拒绝并返回字符串 <code>&quot;Time Limit Exceeded&quot;</code> 。</li></ul><p><strong>提示：</strong></p><ul><li><code>0 &lt;= inputs.length &lt;= 10</code></li><li><code>0 &lt;= t &lt;= 1000</code></li><li><code>fn</code> 返回一个 Promise 对象</li></ul><h2 id="解题思路" tabindex="-1"><a class="header-anchor" href="#解题思路" aria-hidden="true">#</a> 解题思路</h2><ol><li>在 <code>timeLimit</code> 中返回了一个新的异步函数，并通过 <code>Promise</code> 来控制结果的返回。</li><li>设置一个定时器 <code>setTimeout</code> 用来判断 <code>fn</code> 是否超时，当超过给定的时间 <code>t</code> 时，定时器将触发，拒绝 Promise 并返回 <code>&quot;Time Limit Exceeded&quot;</code>。</li><li>执行异步函数 <code>fn</code>，如果 <code>fn</code> 在规定时间内完成，无论是成功还是失败，都清理定时器以确保其不会再次执行。</li></ol><h4 id="复杂度分析" tabindex="-1"><a class="header-anchor" href="#复杂度分析" aria-hidden="true">#</a> 复杂度分析</h4><ul><li><strong>时间复杂度</strong>：取决于传入的 <code>fn</code> 的复杂度，假设为 <code>O(fn)</code>。</li><li><strong>空间复杂度</strong>：<code>O(1)</code>，仅有定时器和 Promise 相关的内存开销。</li></ul><h2 id="代码" tabindex="-1"><a class="header-anchor" href="#代码" aria-hidden="true">#</a> 代码</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span> <span class="token parameter">fn</span>
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token punctuation">}</span></span> <span class="token parameter">t</span>
 * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span>
 */</span>
<span class="token keyword">var</span> <span class="token function-variable function">timeLimit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 超时后拒绝 Promise</span>
			<span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;Time Limit Exceeded&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// 执行异步函数 fn</span>
			<span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 成功时清除定时器</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 失败时清除定时器</span>
					<span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * const limited = timeLimit((t) =&gt; new Promise(res =&gt; setTimeout(res, t)), 100);
 * limited(150).catch(console.log) // &quot;Time Limit Exceeded&quot; at t=100ms
 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="相关题目" tabindex="-1"><a class="header-anchor" href="#相关题目" aria-hidden="true">#</a> 相关题目</h2>`,15),P=t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"题号"),t("th",{style:{"text-align":"left"}},"标题"),t("th",{style:{"text-align":"center"}},"题解"),t("th",{style:{"text-align":"left"}},"标签"),t("th",{style:{"text-align":"left"}},"难度"),t("th",{style:{"text-align":"center"}},"力扣")])],-1),j=t("td",{style:{"text-align":"center"}},"2621",-1),I=t("td",{style:{"text-align":"left"}},"睡眠函数",-1),O={style:{"text-align":"center"}},C=t("td",{style:{"text-align":"left"}},null,-1),N=t("td",{style:{"text-align":"left"}},"🟢",-1),V={style:{"text-align":"center"}},B={href:"https://leetcode.cn/problems/sleep",target:"_blank",rel:"noopener noreferrer"},M={href:"https://leetcode.com/problems/sleep",target:"_blank",rel:"noopener noreferrer"},F=t("td",{style:{"text-align":"center"}},"2622",-1),R=t("td",{style:{"text-align":"left"}},"有时间限制的缓存",-1),G={style:{"text-align":"center"}},H=t("td",{style:{"text-align":"left"}},null,-1),S=t("td",{style:{"text-align":"left"}},"🟠",-1),z={style:{"text-align":"center"}},A={href:"https://leetcode.cn/problems/cache-with-time-limit",target:"_blank",rel:"noopener noreferrer"},D={href:"https://leetcode.com/problems/cache-with-time-limit",target:"_blank",rel:"noopener noreferrer"},J=t("td",{style:{"text-align":"center"}},"2627",-1),K=t("td",{style:{"text-align":"left"}},"函数防抖",-1),Q={style:{"text-align":"center"}},U=t("td",{style:{"text-align":"left"}},null,-1),W=t("td",{style:{"text-align":"left"}},"🟠",-1),X={style:{"text-align":"center"}},Y={href:"https://leetcode.cn/problems/debounce",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://leetcode.com/problems/debounce",target:"_blank",rel:"noopener noreferrer"},$=t("td",{style:{"text-align":"center"}},"2636",-1),tt=t("td",{style:{"text-align":"left"}},"Promise 对象池 🔒",-1),nt={style:{"text-align":"center"}},et=t("td",{style:{"text-align":"left"}},null,-1),st=t("td",{style:{"text-align":"left"}},"🟠",-1),at={style:{"text-align":"center"}},ot={href:"https://leetcode.cn/problems/promise-pool",target:"_blank",rel:"noopener noreferrer"},lt={href:"https://leetcode.com/problems/promise-pool",target:"_blank",rel:"noopener noreferrer"},it=t("td",{style:{"text-align":"center"}},"2676",-1),ct=t("td",{style:{"text-align":"left"}},"节流 🔒",-1),pt={style:{"text-align":"center"}},rt=t("td",{style:{"text-align":"left"}},null,-1),ut=t("td",{style:{"text-align":"left"}},"🟠",-1),dt={style:{"text-align":"center"}},mt={href:"https://leetcode.cn/problems/throttle",target:"_blank",rel:"noopener noreferrer"},ht={href:"https://leetcode.com/problems/throttle",target:"_blank",rel:"noopener noreferrer"};function _t(kt,ft){const c=l("font"),s=l("ExternalLinkIcon"),o=l("RouterLink");return r(),u("div",null,[h,t("p",null,[n("🟠 "),e(c,{color:"#ffb800"},{default:a(()=>[n("Medium")]),_:1}),n("  🔗 "),t("a",_,[k,e(s)]),n(),t("a",f,[g,e(s)])]),v,b,x,y,w,T,E,L,q,d(" prettier-ignore "),t("table",null,[P,t("tbody",null,[t("tr",null,[j,I,t("td",O,[e(o,{to:"/problem/2621.html"},{default:a(()=>[n("[✓]")]),_:1})]),C,N,t("td",V,[t("a",B,[n("🀄️"),e(s)]),n(),t("a",M,[n("🔗"),e(s)])])]),t("tr",null,[F,R,t("td",G,[e(o,{to:"/problem/2622.html"},{default:a(()=>[n("[✓]")]),_:1})]),H,S,t("td",z,[t("a",A,[n("🀄️"),e(s)]),n(),t("a",D,[n("🔗"),e(s)])])]),t("tr",null,[J,K,t("td",Q,[e(o,{to:"/problem/2627.html"},{default:a(()=>[n("[✓]")]),_:1})]),U,W,t("td",X,[t("a",Y,[n("🀄️"),e(s)]),n(),t("a",Z,[n("🔗"),e(s)])])]),t("tr",null,[$,tt,t("td",nt,[e(o,{to:"/problem/2636.html"},{default:a(()=>[n("[✓]")]),_:1})]),et,st,t("td",at,[t("a",ot,[n("🀄️"),e(s)]),n(),t("a",lt,[n("🔗"),e(s)])])]),t("tr",null,[it,ct,t("td",pt,[e(o,{to:"/problem/2676.html"},{default:a(()=>[n("[✓]")]),_:1})]),rt,ut,t("td",dt,[t("a",mt,[n("🀄️"),e(s)]),n(),t("a",ht,[n("🔗"),e(s)])])])])])])}const vt=p(m,[["render",_t],["__file","2637.html.vue"]]);export{vt as default};

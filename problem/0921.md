# [921. 使括号有效的最少添加](https://leetcode.com/problems/minimum-add-to-make-parentheses-valid)

🟠 <font color=#ffb800>Medium</font>&emsp; 🔖&ensp; [`栈`](/tag/stack.md) [`贪心`](/tag/greedy.md) [`字符串`](/tag/string.md)&emsp; 🔗&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-add-to-make-parentheses-valid)

## 题目

<p>只有满足下面几点之一，括号字符串才是有效的：</p>

<ul>
	<li>它是一个空字符串，或者</li>
	<li>它可以被写成&nbsp;<code>AB</code>&nbsp;（<code>A</code>&nbsp;与&nbsp;<code>B</code>&nbsp;连接）, 其中&nbsp;<code>A</code> 和&nbsp;<code>B</code>&nbsp;都是有效字符串，或者</li>
	<li>它可以被写作&nbsp;<code>(A)</code>，其中&nbsp;<code>A</code>&nbsp;是有效字符串。</li>
</ul>

<p>给定一个括号字符串 <code>s</code> ，在每一次操作中，你都可以在字符串的任何位置插入一个括号</p>

<ul>
	<li>例如，如果 <code>s = "()))"</code> ，你可以插入一个开始括号为 <code>"(()))"</code> 或结束括号为 <code>"())))"</code> 。</li>
</ul>

<p>返回 <em>为使结果字符串 <code>s</code> 有效而必须添加的最少括号数</em>。</p>

<p>&nbsp;</p>

<p><strong>示例 1：</strong></p>

<pre>
<strong>输入：</strong>s = "())"
<strong>输出：</strong>1
</pre>

<p><strong>示例 2：</strong></p>

<pre>
<strong>输入：</strong>s = "((("
<strong>输出：</strong>3
</pre>

<p>&nbsp;</p>

<p><strong>提示：</strong></p>

<ul>
	<li><code>1 &lt;= s.length &lt;= 1000</code></li>
	<li><code>s</code> 只包含&nbsp;<code>'('</code> 和&nbsp;<code>')'</code>&nbsp;字符。</li>
</ul>


## 解题思路

1. **初始化两个变量**：

   - `needLeft`：未匹配的左括号数，初始值为 0。
   - `needRight`：需要的右括号数，初始值为 0。

2. **遍历字符串**：

   - 对于每个字符：
     - 如果是左括号 `'('`，将 `needLeft` 变量加 1。
     - 如果是右括号 `')'`：
       - 如果存在未匹配的左括号（即 `needLeft > 0`），则减少 `needLeft`，因为找到了一个右括号可以与之匹配。
       - 否则，增加 `needRight`，因为这是一个未匹配的右括号。

3. **最终结果**：
   - 遍历完成后，剩余的 `needLeft` 表示未匹配的左括号，`needRight` 表示未匹配的右括号。两者之和就是需要添加的括号数量。

#### 复杂度分析

- **时间复杂度**:` O(n)`，其中 `n` 是字符串 `s` 的长度。我们只需要遍历字符串一次。
- **空间复杂度**:` O(1)`，因为我们只使用了两个计数器变量 `needLeft` 和 `needRight`。

## 代码

```javascript
/**
 * @param {string} s
 * @return {number}
 */
var minAddToMakeValid = function (s) {
	let needLeft = 0, // 记录左括号的需求量
		needRight = 0; // 记录右括号的需求量
	for (let char of s) {
		if (char == '(') {
			// 对右括号的需求 + 1
			needRight++;
		} else {
			if (needRight > 0) {
				// 对右括号的需求 - 1
				needRight--;
			} else {
				// 需插入一个左括号
				needLeft++;
			}
		}
	}
	return needLeft + needRight;
};
```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 |
| :------: | :------ | :------: | :------ | :------ |
| 1963 | [使字符串平衡的最小交换次数](https://leetcode.com/problems/minimum-number-of-swaps-to-make-the-string-balanced) | [[✓]](/problem/1963.md) |  [`栈`](/tag/stack.md) [`贪心`](/tag/greedy.md) [`双指针`](/tag/two-pointers.md) `1+` | <font color=#ffb800>Medium</font> |